# Go言語で並列処理
# 目次
1. [並列処理と並行処理](#anchor1)
2. [ゴルーチンとチャネル](#anchor2)
3. [制作途中](#anchor3)
4. [制作途中](#anchor4)
5. [制作途中](#anchor5)
6. [制作途中](#anchor6)

# 1. 並列処理と並行処理 <a id="anchor1"></a>
## そもそも並列処理と並行処理の違い
### 並列処理
- 並列処理はとある時間という点において同時に処理を行うこと
- こちらは複数の処理を同時に**実行**することである
    - 処理自体の動詞を指す

### 並行処理
- 並行処理は時間の期間という線において処理を行うことである
  - この時に優先順位は各々で決めていいことになっている
  - AとBを並列処理してもいいし,Aが終わったとにBをしてもいい
- 複数の処理を独立に実行する**構成**のことを言う
    - つまりこちらは動詞ではなく,施設という意味(実行環境)と言う意味の名詞を指す
- Goルーチンやチャネルなどはこちらを扱うものである

## 並行処理のメリット
- 並行処理で書かれたコードは,CPUで並列に処理してもらえる 
    - それはつまり処理が早くなることを意味する
    - 早くならない場合もある
## 並行処理のデメリット
- 認知負荷が高い
  - そもそもコードを読みにくくなる
- 実装しても早くならない場合がある
  - sequentialな処理はそもそも参照してる部分が依存するため順番を守らないといけず,早くならん
- コンテキストスイッチに多くの時間が食われてしまう場合
  - コンテキストとはCPUが異なるゴールーチンの実行に切り替える処理を指す
    
# 2. ゴルーチンとチャネル <a id="anchor2"></a>
## ゴルーチン
- 簡単に嘔吐他のコードに対して並行に実行している関数である
  - これは並行に実行しても並列ではないという部分が注意する必要がある
## チャネル
- 異なるゴルーチンのなかで,特定の型の値を送受信することでやり取りをおこなうパイプのことを言う
  - ゴルーチンは独立したものであるため,それを関数で使う場合にはチャネルで値を与える必要がある
## チャネルの状態
- nilかどうか
- close済みかどうか
- バッファに値があるかどうか
- 送信専用/受信専用
## バッファ
- バッファはチャネルにデータを一時的に保存するスペース
- バッファが満杯のときにデータを送信しようとすると,ゴルーチンはそのスペースが空くまでブロックされる
- バッファが空のときにデータを受信しようとすると,データが送信されるまでゴルーチンはブロックされる
## バッファ付きチャネル
```go
ch := make(chan int, 5) // 5つのデータを格納できるバッファ付きチャネル
```
このようにすることで,5つのデータを格納することができるチャネルを作ることができる
## バッファなしチャネルの挙動の違い
- バッファなしチャネルでは送信操作と受信操作が同時に行われる必要がある
- 送信ゴルーチンは,対応する受信ゴルーチンがデータを受け取るまでブロックされる
  - この特性を活かして同期処理を行うことができるのである
  ```go
  package main
  
  import (
  "fmt"
  "time"
  )
  
  func produce(ch chan<- string) {
  // 何らかのデータを生成する想定
  time.Sleep(2 * time.Second) // データ生成に時間がかかるシミュレーション
  ch <- "データ生成完了"      // データをチャネルに送信
  }
  
  func consume(ch <-chan string) {
  data := <-ch // チャネルからデータを受信
  fmt.Println("受信したデータ:", data)
  }
  
  func main() {
  ch := make(chan string) // バッファなしチャネルの作成
  
      go produce(ch) // データを生成するゴルーチンを起動
      go consume(ch) // データを消費するゴルーチンを起動
  
      time.Sleep(3 * time.Second) // メインゴルーチンを終了させないための待機
  }
  
  ```
## デッドロックのリスク
- バッファ付きチャネルはブロックを行うため,ケースによってはデッドロックが起こってしまう場合がある
- なので例外処理を行う必要が出てくる
- 
# 3. 制作途中 <a id="anchor3"></a>
# 4. 制作途中 <a id="anchor4"></a>
# 5. 制作途中 <a id="anchor5"></a>
# 6. 制作途中 <a id="anchor6"></a>

